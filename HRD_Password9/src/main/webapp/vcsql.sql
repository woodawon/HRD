create table TBL_JUMIN_201808 (
	JUMIN char(14) not null primary key,
	PNAME varchar2(16),
	TEL varchar2(13),
	ADDRESS varchar2(10)
);

create table TBL_HOSP_202108 (
	HOSPCODE char(4) not null primary key,
	HOSPNAME varchar2(10),
	HOSPTEL varchar2(10),
	HOSPADDR varchar2(10)
);

create table TBL_VACCRESV_202108 (
	RESVNO char(8) not null primary key,
	JUMIN char(14),
	VCODE char(4),
	HOSPCODE char(4),
	RESVDATE char(8),
	RESVTIME char(4)
);

insert into TBL_JUMIN_201808 values ('700101-1000001', '김주민', '010-1234-0001', '서울');
insert into TBL_JUMIN_201808 values ('700101-2000002', '이주민', '010-1234-0002', '서울');
insert into TBL_JUMIN_201808 values ('700101-1000003', '박주민', '010-1234-0003', '서울');
insert into TBL_JUMIN_201808 values ('700101-2000004', '조주민', '010-1234-0004', '대전');
insert into TBL_JUMIN_201808 values ('700101-1000005', '홍주민', '010-1234-0005', '대전');
insert into TBL_JUMIN_201808 values ('700101-2000006', '나주민', '010-1234-0006', '대구');
insert into TBL_JUMIN_201808 values ('700101-1000007', '황주민', '010-1234-0007', '대구');
insert into TBL_JUMIN_201808 values ('700101-2000008', '용주민', '010-1234-0008', '광주');
insert into TBL_JUMIN_201808 values ('700101-1000009', '백주민', '010-1234-0009', '광주');
insert into TBL_JUMIN_201808 values ('700101-2000010', '송주민', '010-1234-0010', '광주');

insert into TBL_HOSP_202108 values ('H001', '가-병원', '1588-0001', '서울');
insert into TBL_HOSP_202108 values ('H002', '나-병원', '1588-0002', '대전');
insert into TBL_HOSP_202108 values ('H003', '다-병원', '1588-0003', '대구');
insert into TBL_HOSP_202108 values ('H004', '라-병원', '1588-0004', '광주');

insert into TBL_VACCRESV_202108 values ('20210001', '700101-1000001', 'V001', 'H001', '20210901', '0920');
insert into TBL_VACCRESV_202108 values ('20210002', '700101-2000002', 'V001', 'H002', '20210901', '1030');
insert into TBL_VACCRESV_202108 values ('20210003', '700101-1000003', 'V002', 'H003', '20210902', '1130');
insert into TBL_VACCRESV_202108 values ('20210004', '700101-2000004', 'V002', 'H001', '20210902', '1230');
insert into TBL_VACCRESV_202108 values ('20210005', '700101-1000005', 'V002', 'H002', '20210902', '1330');
insert into TBL_VACCRESV_202108 values ('20210006', '700101-2000006', 'V003', 'H003', '20210903', '1430');
insert into TBL_VACCRESV_202108 values ('20210007', '700101-1000007', 'V003', 'H001', '20210903', '1530');
insert into TBL_VACCRESV_202108 values ('20210008', '700101-2000008', 'V003', 'H002', '20210903', '1630');
insert into TBL_VACCRESV_202108 values ('20210009', '700101-1000009', 'V003', 'H003', '20210904', '1730');
insert into TBL_VACCRESV_202108 values ('20210010', '700101-2000010', 'V003', 'H001', '20210904', '1830');

select TBL_VACCRESV_202108.RESVNO as RESVNO, TBL_JUMIN_201808.PNAME as PNAME, TBL_VACCRESV_202108.JUMIN as JUMIN,TBL_JUMIN_201808.TEL as TEL, TBL_VACCRESV_202108.RESVDATE as RESVDATE, TBL_VACCRESV_202108.RESVTIME as RESVTIME, TBL_HOSP_202108.HOSPNAME as HOSPNAME, TBL_HOSP_202108.HOSPTEL as HOSPTEL, TBL_HOSP_202108.HOSPADDR as HOSPADDR, TBL_VACCRESV_202108.VCODE as VCODE  from TBL_VACCRESV_202108 left join TBL_HOSP_202108 on TBL_HOSP_202108.HOSPCODE = TBL_VACCRESV_202108.HOSPCODE left join TBL_JUMIN_201808 on TBL_JUMIN_201808.JUMIN = TBL_VACCRESV_202108.JUMIN;

select TBL_HOSP_202108.HOSPCODE, TBL_HOSP_202108.HOSPNAME, count(*) from TBL_VACCRESV_202108, TBL_HOSP_202108  where TBL_VACCRESV_202108.HOSPCODE = TBL_HOSP_202108.HOSPCODE group by TBL_HOSP_202108.HOSPCODE, TBL_HOSP_202108.HOSPNAME;
